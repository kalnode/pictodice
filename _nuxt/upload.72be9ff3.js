import{C as $,_ as T,a as B}from"./ImageCropper.7c200115.js";import{z as M,L as N,b as R,r as z,e as r,f as u,F as p,E as g,u as a,h,w as F,T as U,o as c,H as _,t as y,j as d,M as A,v as H}from"./entry.a6391998.js";const P={class:"w-full h-full flex flex-col justify-center items-center"},V={class:"flex flex-wrap justify-center px-6 mb-4"},E=["onClick"],O=["innerHTML"],q={key:0,class:"w-full h-full fixed z-50 top-0 bg-black bg-opacity-70 flex justify-center items-center"},X={class:"overflow-auto px-10"},G={class:"flex justify-center items-center flex-wrap pb-48"},J=["onClick"],K=["onClick"],Q=["src"],W={key:2,class:"p-2 text-base md:text-2xl text-center font-bold italic uppercase"},Y={key:3,class:"flex justify-center items-center bg-white w-full h-full text-3xl font-bold"},se={__name:"upload",setup(Z){const{$convertBlobToBase64:b,$writeFile:w,$deleteFile:v}=M(),m=N(),e=R(),k=H(),i=z(!1);async function x(s){console.log("Image slot clicked %O",s),i.value=!0,await D(s).then(()=>{console.log("after image work 111")}).catch(()=>{console.log("after image work 222")}),console.log("after image work 333"),i.value=!1}async function D(s){return new Promise(async(l,n)=>{let t=await $.pickImages({quality:90,limit:1}).catch(o=>{n(o)});if(t&&t.photos&&t.photos.length>0){let o=t.photos[0];const L=await(await fetch(o.webPath)).blob();let S=await b(L);m.open(T,{imageSrc:S,context_ui:"modal"},[{label:"Ok",actionType:"primary",callback:I=>{C(I,s),m.close(),l("Success")}}])}else n("No images selected")})}async function C(s,l){let n=Date.now()+".png";const t=URL.createObjectURL(s);e.dice[e.currentDie].images[l].type="localStorage",e.dice[e.currentDie].images[l].src=t,e.dice[e.currentDie].images[l].filename=n,e.app.subtype=="web"&&(await w({filename:n,data:s,directory:"images"}),e.setImage({index:l,src:n})),i.value=!1}async function j(s){await v(e.dice[e.currentDie].images[s].filename,"images").then(()=>{e.dice[e.currentDie].images[s].filename="",e.dice[e.currentDie].images[s].src="",e.updateLocalStorage()})}return(s,l)=>{const n=B;return c(),r("div",P,[u("div",V,[(c(!0),r(p,null,g(a(e).dice,(t,o)=>(c(),r("div",{key:"die-"+o,onClick:f=>{a(e).currentDie=o,a(e).updateLocalStorage()},class:_([a(e).currentDie==o?"border-orange-900":"border-transparent","flex items-center p-3 md:p-5 m-1 md:m-2 text-orange-900 bg-orange-100 hover:bg-orange-200 hover:scale-105 transition-transform border-2 rounded cursor-pointer"])},[u("span",null,y(t.name),1),t.icon?(c(),r("div",{key:0,innerHTML:t.icon,class:"w-6 h-6",style:{"margin-right":"-0.7em"}},null,8,O)):d("",!0)],10,E))),128))]),h(U,{name:"fade"},{default:F(()=>[i.value&&a(e).app.type=="native"?(c(),r("div",q,[h(n,{class:"w-24 h-24",color:"#ffffff"})])):d("",!0)]),_:1}),u("div",X,[u("div",G,[(c(!0),r(p,null,g(a(e).dice[a(e).currentDie].images,(t,o)=>(c(),r("div",{key:"slot-"+o,onClick:f=>a(e).dice[a(e).currentDie].type==="custom"?x(o):"",class:_([[a(e).dice[a(e).currentDie].type==="custom"?"cursor-pointer hover:scale-105":"",t.type=="text"?"bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-purple-800 to-violet-900 text-white":"bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-gray-100 to-gray-300 text-black"],"relative w-28 sm:w-32 md:w-48 h-28 sm:h-32 md:h-48 border m-2 md:m-4 bg-white flex justify-center items-center overflow-hidden transition-transform"])},[t.type&&t.src!=""&&t.type=="localStorage"?(c(),r("div",{key:0,onClick:A(f=>j(o),["stop","self"]),class:"w-10 h-10 absolute top-1 right-1 z-50 flex justify-center items-center font-bold rounded-full shadow bg-white hover:bg-gray-100 p-2 hover:scale-110 transition"},"X",8,K)):d("",!0),t.type&&t.src!=""&&t.type!="text"?(c(),r("img",{key:1,src:t.type=="localStorage"?t.src:a(k).app.baseURL+"images/"+t.src,class:"relative w-full h-full object-cover object-center"},null,8,Q)):t.type=="text"?(c(),r("span",W,y(t.src),1)):(c(),r("div",Y,"+"))],10,J))),128))])])])}}};export{se as default};
